{% extends "layout.html" %}
{% block content %}

<div class="card center">
    <h2>Iniciar sesión</h2>

    <label>Email:</label>
    <input id="login-email" type="email">

    <label>Contraseña:</label>
    <input id="login-pass" type="password">

    <button onclick="login()">Ingresar</button>

    <p>¿No tienes cuenta? <a href="#" onclick="showRegister()">Crear cuenta</a></p>
    <p id="login-status" class="status"></p>
</div>

<script>
function showRegister() {
    window.location.href = "/register_page";
}

async function login() {
    const email = document.getElementById("login-email").value;
    const pass = document.getElementById("login-pass").value;

    const r = await fetch("/auth/login", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({email: email, password: pass})
    });

    const res = await r.json();

    if (!res.ok) {
        document.getElementById("login-status").textContent = res.error;
        return;
    }

    if (res.is_admin) window.location.href = "/admin";
    else window.location.href = "/";
}
</script>

{% endblock %}
